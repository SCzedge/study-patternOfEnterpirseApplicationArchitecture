# chap10 데이터 원본 아키텍처 패턴

## 테이블 데이터 게이트웨이
- 단일 테이블이나 뷰에 접근하는 모든 sql을 포함하며 테입ㄹ 데이터 게이트웨이 메소드를 호출해 데이터베이스와의 상호작용을 수행할 수 있다.

### 작동원리
- 일반적으로 데이터베이스 CURD로 구성된 간단한 인터페이스를 가지며 상태 비저장이다.
- 테이블 당 하나씩 사용하는 경우가 많으며 간단한 경우에는 모든테이블의 모든 메서드를 처리할 수도 있음.
- 뷰 기반 테이블 데이터 게이트웨이는 업데이트 할 수 없으므로 업데이트 동작이 없으나, 기반 테이블 업데이트시에는 작업 뒤에서 캡슐화 하는것이 바람직

정보를 반환하는 방법  
- 일반적으로 가장 어려운 부분
- 여러 언어에서는 단일값만 반환할 수 있으나, 쿼리중에는 여러행을 반환하는것이 많음.  

1. 간단한 자료구조(ex.map)를 반환하는 방법
  - 데이터베이스 레코드집합을 map으로 복사시 컴파일검사가 없고 인터페이스가 비명시적이므로 권장되지 않으며, 데이터 전송객체를 사용하는것이 나음

2. 쿼리에서 얻은 레코드 집합 반환 방법
  - 인메모리 객체가 sql인터페이스에 대해 알게 되므로 개념상 엉망이되고 데이터베이스를 파일로 대체하기도 어려우므로 비권장됨
  - .NET환경에서는 매우 효과적이며 테이블 모듈과 함께 사용시 적합.
  - 모든 업데이트가 테이블 데이터 게이트웨이를 통해 실행시 반환데이터를 뷰를 기반으로 둘 수 있고 이경우 코드와 데이터베이스간 결합 감소
  
3. 도메인 모델 사용
  - 테이블 데이터 게이트웨이가 도메인 객체를 반환하는 경우 도메인객체와 게이트웨이 간 양방향 의존 발생

### 사용시점
- 게이트웨이 사용 여부 판단 후 방식 결정
- 테이블이나 레코드에 매핑이 쉬우므로 간단하게 사용가능한 데이터베이스 인터페이스 패턴이며 데이터 원본 접근논리 캡슐화에 적합한 위치.
- 테이블 데이터 게이트웨이는 테이블 모듈과 잘 어울리며 테이블 모듈이 작업할 레코드 집합 자료구조 생성이 가능하다.
- 테이블 데이터 게이트웨이는 트랜잭션 스크립트와 사용하는데 적합하며 데이터 행 처리법에 따라 둘 중 선택이 달라진다.
- 데이터 전송객체가 재사용 되지 않는경우 많은 작업이 필요하므로 사용에 주의할것.



