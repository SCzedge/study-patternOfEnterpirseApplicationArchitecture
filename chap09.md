# chap09 도메인 논리 패턴
## 트랜잭션 스크립트
트랜잭션 스크립트는 모든 논리를 단일 프로시저로 구성하고 데이터베이스를 호출한다.

### 작동원리
- 다른 프로그램과 마찬가지로 코드 모듈화 필요
- 다른 트랜잭션을 신경 쓸 필요가 없는것이 장점.
- 위치를 최대한 분리하여 최소 별도의 서브루틴을 사용하고 프레젠테이션논리 호출을 최소화해 수정 및 테스트를 용이하게 해야함

트랜잭션 스크립트 클래스 구성 방법  
1. 여러 트랜잭션을 한 클래스에 넣고 각 클래스에서 연관된 주제 영역 정의
2. 각 트랜잭션을 자체 클래스에 넣고 상위 형식정의 후 트랜잭션 스크립트 논리가 포함될 실행메소드 지정
  - 스크립트 인스턴스를 런타임 객체로 조작 가능

### 사용시점
- 트랜잭션 스크립트는 단순하므로 작은규모에 적합. 비즈니스 논리 복잡시 공통 코드 중복 등 설계가 복잡해짐.  
- 복잡한 비즈니스 도메인일 경우 도메인 모델을 사용해야 하나 리팩터링이 어려우므로 처음부터 도메인 모델로 설계 권장
- 트랜잭션 스크립트를 무조건적으로 배제하지 말고 단순한 문제는 빠르게 처리 할 것.

### 수익 인식 문제
자바를 사용한 트랜잭션 스크립트 예제 소개
- 도메인 모델과 비교할시 트랜잭션 스크립트 예제가 훨씬 간단하나 규칙 복잡도 증가시 해결 난이도 상승.

## 도메인 모델
비즈니스 논리는 매우 복잡할 수 있으며, 객체는 복잡성 처리를 위해 고안됨.

### 작동 원리
- 도메인 모델 구현과정은 비즈니스 영역 모델링 객체로 구성된 계층 구성 과정임.  
- 도메인 모델은 데이터베이스 모델과 비슷해 보이나 차이가 존재함
  - 데이터 프로세스가 혼합된 구조
  - 다중값 속성, 복잡한연결망 있음
  - 상속 사용
이때문에 주로 두가지 형식의 도메인 모델 사용
1. 단순 도메인 모델
  - 대부분 도메인 객체가 데이터베이스 테이블과 일치하므로 외형상 데이터베이스 설계와 비슷해보임
  - 활성 레코드 사용가능
2. 리치 도메인 모델
  - 상속, 전략, 다양한(gang of four)패턴, 상호 연결된 객체 연결망 포함
  - 복잡한 논리 표현에 적합하나 데이터베이스 매핑이 어려움
  - 데이터 매퍼 필요

비즈니스 동작 계층은 변경이 잦으므로 쉽게 수정 구축 테스트 할 수 있어야함.
  - 도메인 모델과 다른 계층간 결함을 최소화 한다.

도메인 모델은 다양한 범위 사용이 가능하다.
1. 파일에서 전체 객체를 읽어 메모리에 저장
  - 데스크탑 어플리케이션은 가능하지만 다중계층 IS 어플리케이션은 힘듬
  - 객체지향 데이터베이스 장점은 모든 객체가 메모리에 있는것 처럼 사용가능 하다는것.
2. 세션간 연관 객체만 가져오기
  - 모든 객체, 클래스가 포함되는것이 아님.
  - 어떤것을 가져올지는 데이터베이스 매핑 객체에 의해 결정됨

도메인 객체가 비대해질 시  
- 일반 동작 클래스와 사례별 클래스(트랜잭션스크립트, 프레젠테이션 등)로 분리할 수 있으나, 중복이 발생해 복잡성과 일관성 문제 발생가능.  
- 객체 비대화는 빈도가 낮으며 쉽게 찾고 수정할 수 있으므로 적당한 곳에 모두 넣는것이 좋음.

#### 자바구현
* J2EE 내 도메인 모델 개발 방법
- 도메인 논리가 복잡하지 않을 시 엔터티 빈을 도메인 모델로 사용해도 좋음.
- 상속, 전략 등 다른 패턴이 포함된 도메인 논리 사용시 POJO 도메인 모델과 데이터 매퍼 생성이 권장됨.

### 사용시점
시스템이 수행하는 동작의 복잡도에 따른다.
  - 유효성검사, 계산 등 복잡하고 변화하는 비즈니스 규칙 구현시 객체모델 사용이 권장.
  - 간단한 null처리, 합계 계산 등이 전부라면 트랜잭션 스크립트가 더 나을 수 있음.
  - 팀원의 도메인 객체 사용 숙련도나 러닝커브도 고려하여야함.

도메인 모델 사용시
  - 데이터베이스 매퍼 사용 시 도메인 모델을 데이터베이스에 독립적으로 유지 가능.
  - 데이터베이스 매퍼 사용 시 도메인 모델과 스키마가 분화되는 경우 대처에도 좋음.
  - 도메인 모델에 더 고유한 API적용시 서비스 계층 사용 고려.

### 참고자료
자바를 사용한 도메인 모델 소개 예제  
간단한 작업시에도 여러 클래스 상호작용
  - 특정 클래스를 찾는데 시간이 오래걸림
  - 복잡도 증가시 동작을 객체 안에 유지해 중복을 방지하고 결합을 줄이는 장점이 있음.

GOF패턴
  - 객체지향 패턴으로 작업 그룹을 작은 클래스 계층으로 결합할 수 있다.
  - 어플리케이션 확장이 가능한 조직화된 연결점 제공.

## 테이블 모듈
도메인 모델의 문제점 중 하나는 관계형 데이터 베이스와의 인터페이스가 까다롭다는 것이다.

테이블 모듈
  - 데이터베이스의 테이블 당 클래스 하나로 도메인 논리 구성.
  - 클래스의 한 인스턴스가 해당 데이터에 대한 여러 프로시저 포함
  - 도메인모델은 요청 수만큼 객체 사용, 테이블 모듈은 모든 요청을 객체 하나












































